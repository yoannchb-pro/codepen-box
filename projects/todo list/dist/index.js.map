{"version":3,"file":"index.js","sources":["../index.ts"],"sourcesContent":["import Sortable from \"sortablejs\";\r\n\r\ntype Todo = { text: string; checked: boolean };\r\ntype EventSetUpParameters = {\r\n  todo: Todo;\r\n  title: HTMLInputElement;\r\n  container: HTMLDivElement;\r\n  update: HTMLElement;\r\n  trash: HTMLElement;\r\n};\r\n\r\nconst todoList = document.querySelector<HTMLElement>(\".todo-list\");\r\nconst inputTodo = document.querySelector<HTMLInputElement>(\".add-todo input\");\r\nconst addBtn = document.querySelector(\".add-todo i\");\r\nconst darkMode = document.querySelector(\"#darkmode\");\r\n\r\nconst todos: Todo[] = loadStorage() ?? [\r\n  { text: \"Try light mode\", checked: false },\r\n  { text: \"Try drag and drop\", checked: false },\r\n  { text: \"Try pressing a todo to check it\", checked: false },\r\n  { text: \"Try removing a todo\", checked: false },\r\n  { text: \"Try editing a todo\", checked: false },\r\n  { text: \"Make a cake: eggs, milk, sugar, chocolate\", checked: true },\r\n];\r\n\r\n/**\r\n * Get if the lightmode is enabled or not from localstorage\r\n * @returns\r\n */\r\nfunction getLightModeIsEnabled(): boolean {\r\n  return JSON.parse(localStorage.lightMode ?? \"false\");\r\n}\r\n\r\n/**\r\n * Update the actual localstorage lightmode value\r\n */\r\nfunction updateLightModeStorage() {\r\n  localStorage.lightMode = JSON.stringify(!getLightModeIsEnabled());\r\n}\r\n\r\n/**\r\n * Load the todos list from the storage\r\n * @returns\r\n */\r\nfunction loadStorage(): Todo[] | undefined {\r\n  return localStorage.todos ? JSON.parse(localStorage.todos) : undefined;\r\n}\r\n\r\n/**\r\n * Update the todos list in the storage\r\n */\r\nfunction updateStorage() {\r\n  localStorage.todos = JSON.stringify(todos);\r\n}\r\n\r\n/**\r\n * Setup events on a todo\r\n * Check, trash, update\r\n * @param param0\r\n */\r\nfunction setEvents({\r\n  todo,\r\n  title,\r\n  container,\r\n  update,\r\n  trash,\r\n}: EventSetUpParameters) {\r\n  title.addEventListener(\"click\", function () {\r\n    if (!title.getAttribute(\"readonly\")) return;\r\n    const index = todos.findIndex((e) => e === todo);\r\n    todos[index].checked = !todos[index].checked;\r\n    container.classList.toggle(\"checked\");\r\n    updateStorage();\r\n  });\r\n\r\n  trash.addEventListener(\"click\", function () {\r\n    const index = todos.findIndex((e) => e === todo);\r\n    todos.splice(index, 1);\r\n    container.classList.remove(\"show\");\r\n    container.addEventListener(\"transitionend\", container.remove);\r\n    updateStorage();\r\n  });\r\n\r\n  update.addEventListener(\"click\", function () {\r\n    if (todo.checked) return;\r\n    const titleSize = title.value.length;\r\n    title.removeAttribute(\"readonly\");\r\n    title.focus();\r\n    title.setSelectionRange(titleSize, titleSize);\r\n  });\r\n\r\n  const updateFn = function () {\r\n    const trimmed = title.value?.trim();\r\n\r\n    if (trimmed === \"\") {\r\n      title.focus();\r\n      return;\r\n    }\r\n\r\n    const index = todos.findIndex((e) => e === todo);\r\n    title.setAttribute(\"readonly\", \"true\");\r\n    todos[index].text = trimmed;\r\n    updateStorage();\r\n  };\r\n\r\n  title.addEventListener(\"focusout\", updateFn);\r\n  title.addEventListener(\r\n    \"keydown\",\r\n    (event) => event.key === \"Enter\" && updateFn()\r\n  );\r\n}\r\n\r\n/**\r\n * Create the todo element and set up events on it\r\n * @param todo\r\n */\r\nfunction addTodo(todo: Todo) {\r\n  const container = document.createElement(\"div\");\r\n  container.classList.add(\"todo\");\r\n  window.requestAnimationFrame(() => container.classList.add(\"show\"));\r\n  if (todo.checked) container.classList.add(\"checked\");\r\n\r\n  const title = document.createElement(\"input\");\r\n  title.type = \"text\";\r\n  title.setAttribute(\"readonly\", \"true\");\r\n  title.value = todo.text;\r\n\r\n  const update = document.createElement(\"i\");\r\n  update.className = \"fa-solid fa-pen\";\r\n\r\n  const trash = document.createElement(\"i\");\r\n  trash.className = \"fa-solid fa-trash-can\";\r\n\r\n  container.appendChild(title);\r\n  container.appendChild(update);\r\n  container.appendChild(trash);\r\n\r\n  setEvents({ todo, title, container, update, trash });\r\n\r\n  todoList.appendChild(container);\r\n\r\n  updateStorage();\r\n}\r\n\r\n/**\r\n * Function to add a new todo and reset the add input\r\n * @returns\r\n */\r\nfunction addFn() {\r\n  const trimmed = inputTodo.value?.trim();\r\n  if (trimmed === \"\") return;\r\n\r\n  const todo = { checked: false, text: trimmed };\r\n  todos.push(todo);\r\n  addTodo(todo);\r\n\r\n  inputTodo.value = \"\";\r\n}\r\n\r\n//allow drag and drop\r\nSortable.create(todoList, {\r\n  onUpdate(event) {\r\n    const oldIndex = event.oldIndex;\r\n    const newIndex = event.newIndex;\r\n    const temp = todos.splice(oldIndex, 1)[0];\r\n    todos.splice(newIndex, 0, temp);\r\n    updateStorage();\r\n  },\r\n});\r\n\r\n//handle key \"Enter\" pressed to add a new todo\r\ninputTodo.addEventListener(\r\n  \"keydown\",\r\n  (event) => event.key === \"Enter\" && addFn()\r\n);\r\naddBtn.addEventListener(\"click\", addFn);\r\n\r\n//event listener to toggle light mode/dark mode\r\ndarkMode.addEventListener(\"click\", function () {\r\n  document.documentElement.classList.toggle(\"light\");\r\n  updateLightModeStorage();\r\n});\r\n\r\n//at start if the light mode is enabled in the localstorage we set it as true\r\nif (getLightModeIsEnabled() === true)\r\n  document.documentElement.classList.add(\"light\");\r\n\r\n//we create all the template todos or loaded from the localstorage at start\r\nfor (const todo of todos) {\r\n  addTodo(todo);\r\n}\r\n"],"names":[],"mappings":"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"}