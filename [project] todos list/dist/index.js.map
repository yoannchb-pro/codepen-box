{"version":3,"file":"index.js","sources":["../index.ts"],"sourcesContent":["import Sortable from \"sortablejs\";\r\n\r\ntype Todo = { text: string; checked: boolean };\r\n\r\nconst todoList = document.querySelector<HTMLElement>(\".todo-list\");\r\nconst inputTodo = document.querySelector<HTMLInputElement>(\".add-todo input\");\r\nconst addBtn = document.querySelector(\".add-todo i\");\r\nconst darkMode = document.querySelector(\"#darkmode\");\r\n\r\nfunction getLightModeIsEnabled(): boolean {\r\n  return JSON.parse(localStorage.lightMode ?? \"false\");\r\n}\r\n\r\nfunction updateLightModeStorage() {\r\n  localStorage.lightMode = JSON.stringify(!getLightModeIsEnabled());\r\n}\r\n\r\nfunction loadStorage(): Todo[] | undefined {\r\n  return localStorage.todos ? JSON.parse(localStorage.todos) : undefined;\r\n}\r\n\r\nfunction updateStorage() {\r\n  localStorage.todos = JSON.stringify(todos);\r\n}\r\n\r\nconst todos: Todo[] = loadStorage() ?? [\r\n  { text: \"Try light mode\", checked: false },\r\n  { text: \"Try drag and drop\", checked: false },\r\n  { text: \"Try pressing a todo to check it\", checked: false },\r\n  { text: \"Try removing a todo\", checked: false },\r\n  { text: \"Try editing a todo\", checked: false },\r\n  { text: \"Make a cake: eggs, milk, sugar, chocolate\", checked: true },\r\n];\r\n\r\nfunction setEvents(todo: {\r\n  todo: Todo;\r\n  title: HTMLInputElement;\r\n  container: HTMLDivElement;\r\n  update: HTMLElement;\r\n  trash: HTMLElement;\r\n}) {\r\n  todo.title.addEventListener(\"click\", function () {\r\n    if (!todo.title.getAttribute(\"readonly\")) return;\r\n    const index = todos.findIndex((e) => e === todo.todo);\r\n    todos[index].checked = !todos[index].checked;\r\n    todo.container.classList.toggle(\"checked\");\r\n    updateStorage();\r\n  });\r\n\r\n  todo.trash.addEventListener(\"click\", function () {\r\n    const index = todos.findIndex((e) => e === todo.todo);\r\n    todos.splice(index, 1);\r\n    todo.container.classList.remove(\"show\");\r\n    todo.container.addEventListener(\"transitionend\", todo.container.remove);\r\n    updateStorage();\r\n  });\r\n\r\n  todo.update.addEventListener(\"click\", function () {\r\n    if (todo.todo.checked) return;\r\n    todo.title.removeAttribute(\"readonly\");\r\n    todo.title.focus();\r\n    todo.title.setSelectionRange(\r\n      todo.title.value.length,\r\n      todo.title.value.length\r\n    );\r\n  });\r\n\r\n  const updateFn = function () {\r\n    const trimmed = todo.title.value?.trim();\r\n\r\n    if (trimmed === \"\") {\r\n      todo.title.focus();\r\n      return;\r\n    }\r\n\r\n    const index = todos.findIndex((e) => e === todo.todo);\r\n    todo.title.setAttribute(\"readonly\", \"true\");\r\n    todos[index].text = trimmed;\r\n    updateStorage();\r\n  };\r\n\r\n  todo.title.addEventListener(\"focusout\", updateFn);\r\n  todo.title.addEventListener(\r\n    \"keydown\",\r\n    (event) => event.key === \"Enter\" && updateFn()\r\n  );\r\n}\r\n\r\nfunction addTodo(todo: Todo) {\r\n  const container = document.createElement(\"div\");\r\n  container.classList.add(\"todo\");\r\n  if (todo.checked) container.classList.add(\"checked\");\r\n\r\n  const title = document.createElement(\"input\");\r\n  title.type = \"text\";\r\n  title.setAttribute(\"readonly\", \"true\");\r\n  title.value = todo.text;\r\n\r\n  const update = document.createElement(\"i\");\r\n  update.className = \"fa-solid fa-pen\";\r\n\r\n  const trash = document.createElement(\"i\");\r\n  trash.className = \"fa-solid fa-trash-can\";\r\n\r\n  container.appendChild(title);\r\n  container.appendChild(update);\r\n  container.appendChild(trash);\r\n\r\n  setEvents({ todo, title, container, update, trash });\r\n\r\n  todoList.appendChild(container);\r\n\r\n  window.requestAnimationFrame(() => container.classList.add(\"show\"));\r\n\r\n  updateStorage();\r\n}\r\n\r\nfor (const todo of todos) {\r\n  addTodo(todo);\r\n}\r\n\r\nconst addFn = function () {\r\n  const trimmed = inputTodo.value?.trim();\r\n  if (trimmed === \"\") return;\r\n\r\n  const todo = { checked: false, text: trimmed };\r\n  todos.push(todo);\r\n  addTodo(todo);\r\n\r\n  inputTodo.value = \"\";\r\n};\r\n\r\ninputTodo.addEventListener(\r\n  \"keydown\",\r\n  (event) => event.key === \"Enter\" && addFn()\r\n);\r\naddBtn.addEventListener(\"click\", addFn);\r\n\r\ndarkMode.addEventListener(\"click\", function () {\r\n  document.documentElement.classList.toggle(\"light\");\r\n  updateLightModeStorage();\r\n});\r\n\r\nif (getLightModeIsEnabled() === true)\r\n  document.documentElement.classList.add(\"light\");\r\n\r\nSortable.create(todoList, {\r\n  onUpdate(event) {\r\n    const oldIndex = event.oldIndex;\r\n    const newIndex = event.newIndex;\r\n    const temp = todos[newIndex];\r\n    todos[newIndex] = todos[oldIndex];\r\n    todos[oldIndex] = temp;\r\n    updateStorage();\r\n  },\r\n});\r\n"],"names":[],"mappings":";;;;;;;EAIA,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAc,YAAY,CAAC,CAAC;EACnE,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAmB,iBAAiB,CAAC,CAAC;EAC9E,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;EACrD,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;EAErD,SAAS,qBAAqB,GAAA;;MAC5B,OAAO,IAAI,CAAC,KAAK,CAAC,CAAA,EAAA,GAAA,YAAY,CAAC,SAAS,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAI,OAAO,CAAC,CAAC;EACvD,CAAC;EAED,SAAS,sBAAsB,GAAA;MAC7B,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,qBAAqB,EAAE,CAAC,CAAC;EACpE,CAAC;EAED,SAAS,WAAW,GAAA;EAClB,IAAA,OAAO,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC;EACzE,CAAC;EAED,SAAS,aAAa,GAAA;MACpB,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;EAC7C,CAAC;EAED,MAAM,KAAK,GAAW,CAAA,EAAA,GAAA,WAAW,EAAE,MAAI,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA;EACrC,IAAA,EAAE,IAAI,EAAE,gBAAgB,EAAE,OAAO,EAAE,KAAK,EAAE;EAC1C,IAAA,EAAE,IAAI,EAAE,mBAAmB,EAAE,OAAO,EAAE,KAAK,EAAE;EAC7C,IAAA,EAAE,IAAI,EAAE,iCAAiC,EAAE,OAAO,EAAE,KAAK,EAAE;EAC3D,IAAA,EAAE,IAAI,EAAE,qBAAqB,EAAE,OAAO,EAAE,KAAK,EAAE;EAC/C,IAAA,EAAE,IAAI,EAAE,oBAAoB,EAAE,OAAO,EAAE,KAAK,EAAE;EAC9C,IAAA,EAAE,IAAI,EAAE,2CAA2C,EAAE,OAAO,EAAE,IAAI,EAAE;GACrE,CAAC;EAEF,SAAS,SAAS,CAAC,IAMlB,EAAA;EACC,IAAA,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,YAAA;UACnC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC;cAAE,OAAO;EACjD,QAAA,MAAM,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,CAAC;EACtD,QAAA,KAAK,CAAC,KAAK,CAAC,CAAC,OAAO,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC;UAC7C,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;EAC3C,QAAA,aAAa,EAAE,CAAC;EAClB,KAAC,CAAC,CAAC;EAEH,IAAA,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,YAAA;EACnC,QAAA,MAAM,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,CAAC;EACtD,QAAA,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;UACvB,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;EACxC,QAAA,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;EACxE,QAAA,aAAa,EAAE,CAAC;EAClB,KAAC,CAAC,CAAC;EAEH,IAAA,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,YAAA;EACpC,QAAA,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO;cAAE,OAAO;EAC9B,QAAA,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;EACvC,QAAA,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;UACnB,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAC1B,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,EACvB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CACxB,CAAC;EACJ,KAAC,CAAC,CAAC;EAEH,IAAA,MAAM,QAAQ,GAAG,YAAA;;UACf,MAAM,OAAO,GAAG,CAAA,EAAA,GAAA,IAAI,CAAC,KAAK,CAAC,KAAK,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAE,IAAI,EAAE,CAAC;UAEzC,IAAI,OAAO,KAAK,EAAE,EAAE;EAClB,YAAA,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;cACnB,OAAO;EACR,SAAA;EAED,QAAA,MAAM,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,CAAC;UACtD,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;EAC5C,QAAA,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC;EAC5B,QAAA,aAAa,EAAE,CAAC;EAClB,KAAC,CAAC;MAEF,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;MAClD,IAAI,CAAC,KAAK,CAAC,gBAAgB,CACzB,SAAS,EACT,CAAC,KAAK,KAAK,KAAK,CAAC,GAAG,KAAK,OAAO,IAAI,QAAQ,EAAE,CAC/C,CAAC;EACJ,CAAC;EAED,SAAS,OAAO,CAAC,IAAU,EAAA;MACzB,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;EAChD,IAAA,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;MAChC,IAAI,IAAI,CAAC,OAAO;EAAE,QAAA,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;MAErD,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;EAC9C,IAAA,KAAK,CAAC,IAAI,GAAG,MAAM,CAAC;EACpB,IAAA,KAAK,CAAC,YAAY,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;EACvC,IAAA,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;MAExB,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;EAC3C,IAAA,MAAM,CAAC,SAAS,GAAG,iBAAiB,CAAC;MAErC,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;EAC1C,IAAA,KAAK,CAAC,SAAS,GAAG,uBAAuB,CAAC;EAE1C,IAAA,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;EAC7B,IAAA,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;EAC9B,IAAA,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;EAE7B,IAAA,SAAS,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,CAAC;EAErD,IAAA,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;EAEhC,IAAA,MAAM,CAAC,qBAAqB,CAAC,MAAM,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;EAEpE,IAAA,aAAa,EAAE,CAAC;EAClB,CAAC;EAED,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE;MACxB,OAAO,CAAC,IAAI,CAAC,CAAC;EACf,CAAA;EAED,MAAM,KAAK,GAAG,YAAA;;MACZ,MAAM,OAAO,GAAG,CAAA,EAAA,GAAA,SAAS,CAAC,KAAK,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAE,IAAI,EAAE,CAAC;MACxC,IAAI,OAAO,KAAK,EAAE;UAAE,OAAO;MAE3B,MAAM,IAAI,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;EAC/C,IAAA,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;MACjB,OAAO,CAAC,IAAI,CAAC,CAAC;EAEd,IAAA,SAAS,CAAC,KAAK,GAAG,EAAE,CAAC;EACvB,CAAC,CAAC;EAEF,SAAS,CAAC,gBAAgB,CACxB,SAAS,EACT,CAAC,KAAK,KAAK,KAAK,CAAC,GAAG,KAAK,OAAO,IAAI,KAAK,EAAE,CAC5C,CAAC;EACF,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;EAExC,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,YAAA;MACjC,QAAQ,CAAC,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EACnD,IAAA,sBAAsB,EAAE,CAAC;EAC3B,CAAC,CAAC,CAAC;EAEH,IAAI,qBAAqB,EAAE,KAAK,IAAI;MAClC,QAAQ,CAAC,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAElD,QAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE;EACxB,IAAA,QAAQ,CAAC,KAAK,EAAA;EACZ,QAAA,MAAM,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;EAChC,QAAA,MAAM,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;EAChC,QAAA,MAAM,IAAI,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;UAC7B,KAAK,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;EAClC,QAAA,KAAK,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;EACvB,QAAA,aAAa,EAAE,CAAC;OACjB;EACF,CAAA,CAAC;;;;;;"}